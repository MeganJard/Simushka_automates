# Скрипты системы (Актуально на апрель 2025)

Для корректной работы системы необходимо запустить следующие скрипты:

- `scheduler`
- `scheduler2`
- `bitrix_update_min`

---

## Скрипты, запускаемые `scheduler`

### 1. `fastapi_add_markup_to_deals`
Отправляет POST-запрос к API для установки меток в сделках по заданным параметрам лидов.  
Использует фильтрацию по ID и пользовательским полям.

---

### 2. `cdeck_update`
Авторизуется в личном кабинете СДЭК, выгружает заказы за указанный период.  
Обрабатывает данные (включая JSON-поля) и сохраняет в таблицы:

- `cdek_orders`
- `cdek_packages`

---

### 3. `users_from_redhare`
Загружает JSON с данными пользователей с сайта, сортирует их по дате создания.  
Результат сохраняется в таблицу `users_from_redhare`.

---

### 4. `plytix_rhm_aviability`
Получает токен доступа и выгружает данные о продуктах из API Plytix.  
Структурирует категории, объединяет с таблицей семейств и сохраняет в:

- `plytix_products`

---

### 5. `bitrix_goods`
Асинхронно загружает сделки и товары из Bitrix24.  
Преобразует нестандартные поля и сохраняет в:

- `bitrix_deals_w_all_fields`
- `bitrix_deals_goods`

---

### 6. `bitrix_to_sql`
Анализирует продолжительность сделок в каждом статусе Bitrix24.  
Сохраняет результаты в CSV и обновляет данные по звонкам и полям.

---

### 7. `loyalty_cards`
Собирает данные по бонусным картам клиентов из API Yclients (по филиалам).  
Объединяет информацию в таблицу:

- `joined_loyalty_cards`

---

### 8. `historical_title`
Анализирует услуги и должности сотрудников в Yclients.  
Восстанавливает историю должностей по дням и сохраняет в:

- `joined_historical_title`

---

### 9. `bitriv_jardi_job`
Поочерёдно запрашивает лиды из Bitrix24 с начала 2024 года.  
Извлекает поле `UF_CRM_1717750279233`, объединяет и сохраняет в:

- `additional lead data`
